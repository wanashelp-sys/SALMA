(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{1898:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>k});var r=s(5155),a=s(2115),l=s(2619),i=s.n(l),n=s(5239),c=s(9286);class o{constructor(e=0,t="Network Error"){this.status=e,this.text=t}}let d={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:(()=>{if("undefined"!=typeof localStorage)return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,t)=>Promise.resolve(localStorage.setItem(e,t)),remove:e=>Promise.resolve(localStorage.removeItem(e))}})()},m=e=>e?"string"==typeof e?{publicKey:e}:"[object Object]"===e.toString()?e:{}:{},h=async(e,t,s={})=>{let r=await fetch(d.origin+e,{method:"POST",headers:s,body:t}),a=await r.text(),l=new o(r.status,a);if(r.ok)return l;throw l},u=(e,t,s)=>{if(!e||"string"!=typeof e)throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!t||"string"!=typeof t)throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!s||"string"!=typeof s)throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},x=e=>e.webdriver||!e.languages||0===e.languages.length,p=()=>new o(451,"Unavailable For Headless Browser"),b=(e,t)=>{if((e=>!e.list?.length||!e.watchVariable)(e))return!1;var s=e.list,r=e.watchVariable;if(!Array.isArray(s))throw"The BlockList list has to be an array";if("string"!=typeof r)throw"The BlockList watchVariable has to be a string";let a=((e,t)=>e instanceof FormData?e.get(t):e[t])(t,e.watchVariable);return"string"==typeof a&&e.list.includes(a)},g=()=>new o(403,"Forbidden"),f=async(e,t,s)=>{let r=Number(await s.get(e)||0);return t-Date.now()+r},j=async(e,t,s)=>{if(!t.throttle||!s)return!1;((e,t)=>{if("number"!=typeof e||e<0)throw"The LimitRate throttle has to be a positive number";if(t&&"string"!=typeof t)throw"The LimitRate ID has to be a non-empty string"})(t.throttle,t.id);let r=t.id||e;return await f(r,t.throttle,s)>0||(await s.set(r,Date.now().toString()),!1)},y=()=>new o(429,"Too Many Requests"),v={init:(e,t="https://api.emailjs.com")=>{if(!e)return;let s=m(e);d.publicKey=s.publicKey,d.blockHeadless=s.blockHeadless,d.storageProvider=s.storageProvider,d.blockList=s.blockList,d.limitRate=s.limitRate,d.origin=s.origin||t},send:async(e,t,s,r)=>{let a=m(r),l=a.publicKey||d.publicKey,i=a.blockHeadless||d.blockHeadless,n=a.storageProvider||d.storageProvider,c={...d.blockList,...a.blockList},o={...d.limitRate,...a.limitRate};return i&&x(navigator)?Promise.reject(p()):(u(l,e,t),(e=>{if(e&&"[object Object]"!==e.toString())throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"})(s),s&&b(c,s))?Promise.reject(g()):await j(location.pathname,o,n)?Promise.reject(y()):h("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:l,service_id:e,template_id:t,template_params:s}),{"Content-type":"application/json"})}},N="service_tv0lnvr";async function w(e){let{teacher_name:t,teacher_email:s,teacher_code:r,login_url:a}=e;try{return await v.send(N,"template_3doz3mf",{teacher_name:t,teacher_email:s,teacher_code:r,login_url:a}),{success:!0}}catch(e){return console.error("Failed to send teacher email:",e),{success:!1,error:e}}}async function _(e){let{student_name:t,student_email:s,teacher_name:r,teacher_code:a,login_url:l}=e;try{return await v.send(N,"template_jmr3xcd",{student_name:t,student_email:s,teacher_name:r,teacher_code:a,login_url:l}),{success:!0}}catch(e){return console.error("Failed to send student email:",e),{success:!1,error:e}}}function k(){let[e,t]=(0,a.useState)("teacher"),[s,l]=(0,a.useState)(""),[o,d]=(0,a.useState)(""),[m,h]=(0,a.useState)(""),[u,x]=(0,a.useState)(""),[p,b]=(0,a.useState)(""),[g,f]=(0,a.useState)(""),[j,y]=(0,a.useState)(""),[v,N]=(0,a.useState)(""),[k,S]=(0,a.useState)(""),[I,C]=(0,a.useState)(""),[D,q]=(0,a.useState)(!1),[P,O]=(0,a.useState)(""),[T,L]=(0,a.useState)(!1),[X,R]=(0,a.useState)(""),F=async t=>{if(t.preventDefault(),O(""),!s||!o||!u||!p)return void O("يرجى ملء جميع الحقول المطلوبة");if(p.length<6)return void O("كلمة المرور يجب أن تكون 6 أحرف على الأقل");if(p!==g)return void O("كلمتا المرور غير متطابقتين");if(!D)return void O("يجب الموافقة على شروط الاستخدام");if("teacher"===e&&!j)return void O("يرجى إدخال اسم المدرسة");if("student"===e&&(!v||!k||!I))return void O("يرجى ملء جميع بيانات الطالبة");L(!0);try{let{data:t}=await c.ND.from("users").select("username").eq("username",u).single();if(t){O("اسم المستخدم موجود مسبقاً"),L(!1);return}let{data:r}=await c.ND.from("users").select("email").eq("email",o).single();if(r){O("البريد الإلكتروني مستخدم مسبقاً"),L(!1);return}let{data:a,error:l}=await c.ND.from("users").insert({username:u,email:o,phone:m||null,password_hash:p,role:e}).select().single();if(l){console.error("User creation error:",l),O("حدث خطأ أثناء إنشاء الحساب"),L(!1);return}let i=a.user_id;if("teacher"===e){let e=J(),{data:t,error:r}=await c.ND.from("teachers").insert({user_id:i,full_name:s,school:j,teacher_code:e}).select().single();if(r){console.error("Teacher creation error:",r),O("حدث خطأ أثناء إنشاء حساب المعلمة"),L(!1);return}let{error:a}=await c.ND.from("classes").insert({teacher_id:t.teacher_id,class_name:"الفصل الأول",class_code:e});a&&console.error("Class creation error:",a),await w({teacher_name:s,teacher_email:o,teacher_code:e,login_url:"".concat(window.location.origin,"/login")}),R(e),alert("تم إنشاء الحساب بنجاح!\nكود الفصل: ".concat(e,"\n\nتم إرسال الكود إلى بريدك الإلكتروني"))}else{let{data:e,error:t}=await c.ND.from("teachers").select("teacher_id, full_name, user_id").eq("teacher_code",I).single();if(t||!e){O("كود المعلمة غير صحيح"),L(!1);return}let{data:r}=await c.ND.from("classes").select("class_id").eq("teacher_id",e.teacher_id).eq("class_code",I).single(),{data:a,error:l}=await c.ND.from("students").insert({user_id:i,full_name:s,grade:parseInt(v),class_name:k}).select().single();if(l){console.error("Student creation error:",l),O("حدث خطأ أثناء إنشاء حساب الطالبة"),L(!1);return}r&&await c.ND.from("student_classes").insert({student_id:a.student_id,class_id:r.class_id}),await _({student_name:s,student_email:o,teacher_name:e.full_name,teacher_code:I,login_url:"".concat(window.location.origin,"/login")}),alert("تم إنشاء الحساب بنجاح! تم إرسال رسالة ترحيب إلى بريدك الإلكتروني")}setTimeout(()=>{window.location.href="/login"},2e3)}catch(e){console.error("Registration error:",e),O("حدث خطأ أثناء إنشاء الحساب")}finally{L(!1)}},J=()=>{let e="ABCDEFGHJKLMNPQRSTUVWXYZ23456789",t="";for(let s=0;s<6;s++)t+=e.charAt(Math.floor(Math.random()*e.length));return t};return(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center p-6 bg-gradient-to-br from-secondary/20 via-white to-olive/10",children:(0,r.jsx)("div",{className:"w-full max-w-4xl bg-white/95 rounded-3xl shadow-2xl overflow-hidden",children:(0,r.jsxs)("div",{className:"grid md:grid-cols-5",children:[(0,r.jsxs)("div",{className:"md:col-span-2 bg-gradient-to-br from-secondary to-clay p-8 text-white",children:[(0,r.jsxs)(i(),{href:"/",className:"flex items-center gap-2 mb-8",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-white rounded-xl flex items-center justify-center",children:(0,r.jsx)(n.default,{src:"/logo/شعار (1).png",alt:"معمل سلمى",width:40,height:40,className:"object-contain"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"font-bold text-lg",children:"معمل سلمى"}),(0,r.jsx)("div",{className:"text-xs opacity-90",children:"مغامرة الرياضيات"})]})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"inline-flex items-center gap-2 bg-white/20 rounded-full px-4 py-2 text-sm",children:[(0,r.jsx)("span",{children:"teacher"===e?"\uD83D\uDC69‍\uD83C\uDFEB":"\uD83D\uDC67"}),(0,r.jsxs)("span",{children:["تسجيل ","teacher"===e?"معلمة":"طالبة"]})]}),(0,r.jsx)("h2",{className:"text-2xl font-bold",children:"teacher"===e?"مرحباً بك في معمل سلمى \uD83D\uDC4B":"جاهزة للمغامرة؟ \uD83C\uDFAE"}),(0,r.jsx)("p",{className:"text-sm opacity-95",children:"teacher"===e?"حساب المعلمة يمنحك أدوات إدارة الفصول، إنشاء التحديات، ومتابعة تقدّم طالباتك بتقارير ذكية.":"سجّلي حسابك وادخلي عالم التحديات والألعاب التعليمية في معمل سلمى."}),"teacher"===e?(0,r.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-golden",children:"★"}),(0,r.jsx)("span",{children:"لوحة تحكم للمعلمة لمتابعة تقدّم كل طالبة"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-golden",children:"★"}),(0,r.jsx)("span",{children:"إنشاء تحديات فردية وجماعية"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-golden",children:"★"}),(0,r.jsx)("span",{children:"تقارير وبيانات ذكية"})]})]}):(0,r.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-golden",children:"★"}),(0,r.jsx)("span",{children:"ألعاب تعليمية ممتعة"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-golden",children:"★"}),(0,r.jsx)("span",{children:"تحديات ونقاط وأوسمة"})]}),(0,r.jsxs)("li",{className:"flex items-start gap-2",children:[(0,r.jsx)("span",{className:"text-golden",children:"★"}),(0,r.jsx)("span",{children:"متابعة تقدمك خطوة بخطوة"})]})]})]})]}),(0,r.jsxs)("div",{className:"md:col-span-3 p-8",children:[(0,r.jsx)("div",{className:"flex justify-end mb-6",children:(0,r.jsxs)("div",{className:"inline-flex bg-white border-2 border-clay/20 rounded-full p-1 gap-1",children:[(0,r.jsx)("button",{type:"button",onClick:()=>t("teacher"),className:"px-4 py-2 rounded-full text-sm font-semibold transition-all ".concat("teacher"===e?"bg-primary text-white":"text-accent hover:bg-clayLight"),children:"معلمة"}),(0,r.jsx)("button",{type:"button",onClick:()=>t("student"),className:"px-4 py-2 rounded-full text-sm font-semibold transition-all ".concat("student"===e?"bg-primary text-white":"text-accent hover:bg-clayLight"),children:"طالبة"})]})}),P&&(0,r.jsxs)("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-600 text-sm flex items-center gap-2",children:[(0,r.jsx)("span",{children:"⚠️"}),(0,r.jsx)("span",{children:P})]}),(0,r.jsxs)("form",{onSubmit:F,className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"الاسم الثلاثي"}),(0,r.jsx)("input",{type:"text",value:s,onChange:e=>l(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"مثال: سلمى أحمد العسيري",required:!0})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"البريد الإلكتروني"}),(0,r.jsx)("input",{type:"email",value:o,onChange:e=>d(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"example@gmail.com",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"رقم الجوال (اختياري)"}),(0,r.jsx)("input",{type:"tel",value:m,onChange:e=>h(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"05XXXXXXXX"})]})]}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"اسم المستخدم"}),(0,r.jsx)("input",{type:"text",value:u,onChange:e=>x(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"اسم المستخدم",required:!0})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"كلمة المرور"}),(0,r.jsx)("input",{type:"password",value:p,onChange:e=>b(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"6 أحرف على الأقل",required:!0})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"تأكيد كلمة المرور"}),(0,r.jsx)("input",{type:"password",value:g,onChange:e=>f(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"أعيدي كتابة كلمة المرور",required:!0})]}),"teacher"===e&&(0,r.jsxs)("div",{className:"pt-4 border-t-2 border-clay/20",children:[(0,r.jsx)("h3",{className:"font-bold text-accent mb-3",children:"بيانات المعلمة"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"اسم المدرسة"}),(0,r.jsx)("input",{type:"text",value:j,onChange:e=>y(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"مثال: الابتدائية الخامسة - جدة",required:!0})]}),(0,r.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 rounded-lg text-sm text-accent",children:["سيتم إنشاء ",(0,r.jsx)("strong",{children:"كود فصل خاص"})," يمكنك مشاركته مع طالباتك بعد التسجيل."]})]}),"student"===e&&(0,r.jsxs)("div",{className:"pt-4 border-t-2 border-clay/20",children:[(0,r.jsx)("h3",{className:"font-bold text-accent mb-3",children:"بيانات الطالبة"}),(0,r.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"الصف الدراسي"}),(0,r.jsxs)("select",{value:v,onChange:e=>N(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",required:!0,children:[(0,r.jsx)("option",{value:"",children:"اختاري الصف"}),(0,r.jsx)("option",{value:"1",children:"الأول"}),(0,r.jsx)("option",{value:"2",children:"الثاني"}),(0,r.jsx)("option",{value:"3",children:"الثالث"}),(0,r.jsx)("option",{value:"4",children:"الرابع"}),(0,r.jsx)("option",{value:"5",children:"الخامس"}),(0,r.jsx)("option",{value:"6",children:"السادس"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"الفصل"}),(0,r.jsx)("input",{type:"text",value:k,onChange:e=>S(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"مثال: خامس-1",required:!0})]})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("label",{className:"block text-sm font-semibold text-accent mb-1",children:"كود المعلمة"}),(0,r.jsx)("input",{type:"text",value:I,onChange:e=>C(e.target.value),className:"w-full px-4 py-3 border-2 border-clay/20 rounded-lg focus:border-primary focus:outline-none",placeholder:"اكتبي الكود من معلمتك",required:!0}),(0,r.jsx)("p",{className:"text-xs text-accent/70 mt-1",children:"احصلي على هذا الكود من معلمتك للانضمام إلى فصلها"})]})]}),(0,r.jsxs)("div",{className:"flex items-start gap-2",children:[(0,r.jsx)("input",{type:"checkbox",id:"terms",checked:D,onChange:e=>q(e.target.checked),className:"mt-1"}),(0,r.jsxs)("label",{htmlFor:"terms",className:"text-sm text-accent",children:["أوافق على ",(0,r.jsx)("a",{href:"#",className:"text-primary hover:underline",children:"شروط الاستخدام"})," و",(0,r.jsx)("a",{href:"#",className:"text-primary hover:underline",children:" سياسة الخصوصية"})]})]}),(0,r.jsx)("button",{type:"submit",disabled:T,className:"w-full bg-gradient-to-r from-primary to-secondary text-white font-bold py-4 rounded-lg hover:shadow-lg transition-all disabled:opacity-50",children:T?"جاري الإنشاء...":"إنشاء حساب ".concat("teacher"===e?"معلمة":"طالبة"," الآن")}),(0,r.jsxs)("div",{className:"text-center text-sm text-accent",children:["لديكِ حساب مسبقاً؟"," ",(0,r.jsx)(i(),{href:"/login",className:"text-primary hover:underline font-semibold",children:"تسجيل الدخول"})]})]})]})]})})})}v.init("84xd6IihCfLS1SIPD")},4920:(e,t,s)=>{Promise.resolve().then(s.bind(s,1898))},9286:(e,t,s)=>{"use strict";s.d(t,{ND:()=>r});let r=(0,s(6347).UU)("https://ydmavbbgtvkygosbyezv.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlkbWF2YmJndHZreWdvc2J5ZXp2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3OTY5MzgsImV4cCI6MjA3ODM3MjkzOH0.Ri4TmK2Bv7xx3DZl0D0pPK7dOOSM7OkP9FPko_-R3Ys")}},e=>{e.O(0,[850,885,441,255,358],()=>e(e.s=4920)),_N_E=e.O()}]);